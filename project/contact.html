<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contact Us ‚Ä¢ Yosemite Road Trip Guide</title>
  <meta name="description" content="Contact the Yosemite Road Trip Guide with questions, feedback, or collaboration ideas.">
  <link rel="stylesheet" href="styles/styles.css">
</head>
<body>
  <a class="skip-link" href="#main">Skip to main content</a>

  <header class="site-header">
    <a class="brand" href="index.html">Yosemite Road Trip Guide</a>
    <button id="menu-btn" aria-label="Open menu" aria-expanded="false">‚ò∞</button>
    <nav id="site-nav" class="nav" aria-label="Primary">
      <a href="index.html">Home</a>
      <a href="plantrip.html">Plan Your Trip</a>
      <a href="safety.html">Safety Tips</a>
      <a href="contact.html" aria-current="page">Contact</a>
      <a href="references.html">References</a>
    </nav>
    <div class="toggles">
      <button id="theme-toggle" aria-label="Toggle theme">üåì</button>
    </div>
  </header>

  <section class="hero container" aria-label="Contact us">
    <figure class="hero-media">
      <img src="images/yosemite-banner.jpg" alt="Banner view across Yosemite Valley">
      <figcaption class="visually-hidden">Yosemite Valley overlook</figcaption>
    </figure>
    <div class="panel">
      <h1>Contact Us</h1>
      <p>If you have questions, feedback, or collaboration ideas, reach out using the form below.</p>
    </div>
  </section>

  <!-- ===== MAIN (improved form) ===== -->
  <main id="main" class="container">
    <section aria-labelledby="contact-h2">
      <h2 id="contact-h2" class="visually-hidden">Contact form</h2>

      <form id="contactForm" class="card" method="post" action="#" novalidate>
        <!-- Success / error summary -->
        <div id="form-status" class="success" hidden role="status" aria-live="polite"></div>

        <div class="form-grid">
          <!-- Name -->
          <div class="form-field">
            <label for="name" class="req">Your Name</label>
            <input id="name" name="name" type="text" autocomplete="name" required
                   aria-describedby="name-help" aria-invalid="false" />
            <small id="name-help" class="help">At least 2 characters.</small>
            <div class="error-slot" aria-live="polite"></div>
          </div>

          <!-- Email -->
          <div class="form-field">
            <label for="email" class="req">Your Email</label>
            <input id="email" name="email" type="email" autocomplete="email" required
                   aria-describedby="email-help" aria-invalid="false" />
            <small id="email-help" class="help">We‚Äôll only use this to reply to you.</small>
            <div class="error-slot" aria-live="polite"></div>
          </div>

          <!-- Reason -->
          <div class="form-field">
            <label for="reason" class="req">Contact Reason</label>
            <select id="reason" name="reason" required aria-invalid="false">
              <option value="" disabled selected>Select an option</option>
              <option value="general">General Inquiry</option>
              <option value="error">Report an Error</option>
              <option value="technical">Website Issue</option>
              <option value="career">Career Opportunity</option>
            </select>
            <div class="error-slot" aria-live="polite"></div>
          </div>

          <!-- Message (spans two columns on wide screens) -->
          <div class="form-field form-field--full">
            <label for="message" class="req">Message</label>
            <textarea id="message" name="message" rows="6" minlength="10" maxlength="500" required
                      aria-describedby="msg-help msg-count" aria-invalid="false"></textarea>
            <div class="row-between">
              <small id="msg-help" class="help">Be specific. Min 10 characters.</small>
              <small id="msg-count" class="counter">0 / 500</small>
            </div>
            <div class="error-slot" aria-live="polite"></div>
          </div>
        </div>

        <div class="controls">
          <button type="submit" class="btn">Send Message</button>
        </div>

        <p class="muted" style="margin-top:.5rem">
          This is an unofficial, student-built site for WDD 131. For official park information, visit the
          <a href="https://www.nps.gov/yose" target="_blank" rel="noopener">Yosemite National Park website</a>.
        </p>
      </form>
    </section>
  </main>

  <footer class="site-footer">
    <p>¬© 2025 Yosemite Road Trip Guide ‚Ä¢ <a href="references.html">References</a></p>
    <p><small>Last updated: <time id="last-updated" datetime=""></time></small></p>
  </footer>

  <script src="scripts/main.js" defer></script>
  <script src="scripts/last-updated.js" defer></script>

  <!-- Page-specific: validation + UX -->
  <script>
    (function(){
      const form = document.getElementById('contactForm');
      const status = document.getElementById('form-status');
      const nameEl = document.getElementById('name');
      const emailEl = document.getElementById('email');
      const reasonEl = document.getElementById('reason');
      const msgEl = document.getElementById('message');
      const countEl = document.getElementById('msg-count');

      // Prefill name from last submission
      try {
        const cached = JSON.parse(localStorage.getItem('lastContact') || 'null');
        if (cached?.name) nameEl.value = cached.name;
      } catch(_) {}

      // helpers
      const emailOk = (v) => /^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(v);
      function setError(el, msg){
        el.setAttribute('aria-invalid', 'true');
        const slot = el.closest('.form-field').querySelector('.error-slot');
        slot.innerHTML = msg ? '<p class="error">'+msg+'</p>' : '';
      }
      function clearError(el){
        el.setAttribute('aria-invalid', 'false');
        el.closest('.form-field').querySelector('.error-slot').innerHTML = '';
      }

      // live counter for message
      function updateCount(){
        const len = msgEl.value.length;
        countEl.textContent = len + ' / 500';
      }
      msgEl.addEventListener('input', updateCount);
      updateCount();

      // real-time validation
      function validateField(el){
        const v = el.value.trim();
        if (el === nameEl) {
          if (v.length < 2) return setError(el, 'Please enter your name (2+ characters).');
        }
        if (el === emailEl) {
          if (!emailOk(v)) return setError(el, 'Enter a valid email address.');
        }
        if (el === reasonEl) {
          if (!v) return setError(el, 'Please choose a contact reason.');
        }
        if (el === msgEl) {
          if (v.length < 10) return setError(el, 'Message must be at least 10 characters.');
        }
        clearError(el);
      }
      [nameEl, emailEl, reasonEl, msgEl].forEach(el => {
        el.addEventListener('blur', () => validateField(el));
        el.addEventListener('input', () => validateField(el));
      });

      // submit
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        [nameEl, emailEl, reasonEl, msgEl].forEach(validateField);

        const bad = form.querySelector('[aria-invalid="true"]');
        if (bad) {
          status.hidden = false;
          status.className = 'error';
          status.innerHTML = '<p>Please fix the highlighted fields and try again.</p>';
          bad.focus();
          return;
        }

        // record + thank-you
        localStorage.setItem('lastContact', JSON.stringify({
          name: nameEl.value.trim(),
          email: emailEl.value.trim(),
          reason: reasonEl.value,
          when: new Date().toISOString()
        }));

        status.hidden = false;
        status.className = 'success';
        status.innerHTML = `<p>Thanks, <strong>${nameEl.value.trim()}</strong> ‚Äî your ‚Äú${reasonEl.options[reasonEl.selectedIndex].text}‚Äù message was received.</p>`;

        form.reset();
        updateCount();
        nameEl.focus();
      });
    })();
  </script>
</body>
</html>
